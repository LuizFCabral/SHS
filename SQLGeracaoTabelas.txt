/*Aqui está compilado todo o SQL utilizado no projeto.
Apesar de havermos tentado seguir o máximo possível a
documentação, houve ocasiões em que, para facilitar o 
código, o funcionamento do programa e para não perdermos
muito tempo, fizemos algumas mudanças e acréscimos.*/

create table usuario(
    codigo serial primary key,
    cpf varchar(14) unique,
    nome varchar (40),
    data_nascimento date,
    cidade varchar(30)
);

create table usuario_apl(
    codigo serial primary key,
    cpf varchar(14) unique,
    nome varchar(40),
    tipo_pessoa varchar(1)
);

create table agenda(
    codigo serial primary key,
    data_agendamento timestamp,
    codigo_usuario int REFERENCES usuario (codigo),
    data_vacinacao timestamp,
    dose_numero int
);
create table vacina(
    codigo serial primary key,
    descricao varchar(20),
    qtde_dose int
);

CREATE TABLE lote(
	codigo SERIAL PRIMARY KEY,
  descricao VARCHAR(10),
	qtde_unidade INT,
	codigo_vacina INT REFERENCES vacina (codigo),
	dose_disponivel INT 
);

create table movimento_vacina(
    codigo serial primary key,
    codigo_vacina int REFERENCES vacina (codigo),
    data_movimento timestamp,
    tipo_movimento varchar(1),
    qtde_dose int,
    codigo_lote int references lote (codigo) 
);

CREATE TABLE vacinacao(
	codigo SERIAL PRIMARY KEY,
	codigo_usuario INT REFERENCES usuario (codigo),
	codigo_agenda INT REFERENCES agenda (codigo),
	codigo_lote INT REFERENCES lote (codigo),
        codigo_usuario_apl INT REFERENCES usuario_apl (codigo),
        data_aplicacao timestamp
);